<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Mode Timer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        #timer-display {
            font-size: clamp(3rem, 18vw, 5.5rem);
            line-height: 1;
        }
        .timer-ring-container {
            transition: transform 0.5s ease;
        }
        .time-warning .timer-ring-container { animation: pulse 1s infinite; }
        .time-critical .timer-ring-container { animation: shake 0.5s infinite; }

        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.03); } }
        @keyframes shake { 0%, 100% { transform: translate(0, 0) rotate(0); } 25% { transform: translate(2px, -2px) rotate(1deg); } 50% { transform: translate(-2px, 2px) rotate(-1deg); } 75% { transform: translate(2px, 2px) rotate(1deg); } }
        
        .leaderboard-item { transition: all 0.3s ease; }
        .leaderboard-item-clickable { cursor: pointer; }
        .current-leader { transform: scale(1.05); }
        .selected-leaderboard-item { background-color: #eef2ff; border-color: #818cf8 !important; transform: scale(1.05); }
        .eliminated { opacity: 0.5; text-decoration: line-through; background-color: #e2e8f0; }
        #notification { transition: opacity 0.5s, transform 0.5s; }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }
        
        input[type="color"] { -webkit-appearance: none; border: none; width: 32px; height: 32px; cursor: pointer; border-radius: 50%; overflow: hidden; }
        input[type="color"]::-webkit-color-swatch-wrapper { padding: 0; }
        input[type="color"]::-webkit-color-swatch { border: none; border-radius: 50%; }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 flex flex-col items-center min-h-screen p-4">

    <div id="app-container" class="w-full max-w-4xl mx-auto">
        
        <!-- ì„¤ì • ì„¹ì…˜ -->
        <div id="settings-view" class="bg-white p-6 rounded-2xl shadow-lg mb-6">
            <h1 class="text-3xl font-bold text-center text-blue-600 mb-6" data-i18n="settingsTitle">ê²Œì„ íƒ€ì´ë¨¸ ì„¤ì •</h1>
            
            <div class="mb-6">
                <label for="game-name-input" class="text-xl font-semibold mb-3 text-slate-700 block" data-i18n="gameNameLabel">ê²Œì„ ì´ë¦„</label>
                <input type="text" id="game-name-input" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" data-i18n-placeholder="gameNameHint">
            </div>

            <div class="grid md:grid-cols-2 gap-x-8 gap-y-6 border-t pt-6">
                <!-- í”Œë ˆì´ì–´ ì¶”ê°€ -->
                <div>
                    <h2 class="text-xl font-semibold mb-3 text-slate-700" data-i18n="addPlayerTitle">1. í”Œë ˆì´ì–´ ì¶”ê°€</h2>
                    <div class="flex items-center gap-2">
                        <input type="color" id="new-user-color" value="#3b82f6" title="ìƒ‰ìƒ ì„ íƒ">
                        <input type="text" id="new-user-name" class="flex-grow w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" data-i18n-placeholder="playerNameHint">
                        <button id="add-user-btn" class="bg-blue-500 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-600 shadow" data-i18n="addButton">ì¶”ê°€</button>
                    </div>
                    <div id="user-list" class="mt-4 space-y-2 max-h-40 overflow-y-auto pr-2"></div>
                </div>

                <!-- ì‹œê°„ ì„¤ì • -->
                <div>
                    <h2 class="text-xl font-semibold mb-3 text-slate-700" data-i18n="timeSettingsTitle">2. ì‹œê°„ ì„¤ì •</h2>
                    <div class="space-y-4">
                        <div>
                            <div class="flex justify-between items-center">
                                <label for="turn-time" class="block text-sm font-medium text-slate-600" data-i18n="baseTimeLabel">ê¸°ë³¸ ì‹œê°„</label>
                                <button id="turn-time-unit-btn" data-unit="sec" class="text-sm bg-slate-200 text-slate-600 font-semibold px-3 py-1 rounded-full" data-i18n="unitSec">ì´ˆ</button>
                            </div>
                            <input type="number" id="turn-time" value="30" min="1" class="w-full mt-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <div class="flex justify-between items-center">
                                <label for="extra-time" class="block text-sm font-medium text-slate-600" data-i18n="extraTimeLabel">ì¶”ê°€ ì‹œê°„</label>
                                <button id="extra-time-unit-btn" data-unit="sec" class="text-sm bg-slate-200 text-slate-600 font-semibold px-3 py-1 rounded-full" data-i18n="unitSec">ì´ˆ</button>
                            </div>
                            <input type="number" id="extra-time" value="60" min="0" class="w-full mt-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <!-- ê²Œì„ ëª¨ë“œ ì„¤ì • -->
                <div class="md:col-span-2 border-t pt-6">
                    <h2 class="text-xl font-semibold mb-4 text-slate-700" data-i18n="gameModeTitle">3. ê²Œì„ ëª¨ë“œ ì„¤ì •</h2>
                    <div class="space-y-4">
                        <label class="flex items-center gap-3 p-3 bg-slate-50 rounded-lg">
                            <input type="checkbox" id="sudden-death-mode" class="h-5 w-5 rounded text-blue-600 focus:ring-blue-500">
                            <span class="font-medium" data-i18n="suddenDeathLabel">ì„œë“ ë°ìŠ¤ ëª¨ë“œ í™œì„±í™”</span>
                        </label>
                        <div class="p-3 bg-slate-50 rounded-lg">
                            <label class="flex items-center gap-3">
                                <input type="checkbox" id="quick-turn-bonus-mode" checked class="h-5 w-5 rounded text-blue-600 focus:ring-blue-500">
                                <span class="font-medium" data-i18n="quickTurnBonusLabel">í€µ í„´ ë³´ë„ˆìŠ¤</span>
                            </label>
                            <div class="text-sm text-slate-500 mt-2 pl-8" data-i18n="quickTurnBonusDesc">
                                í„´ ì‹œì‘ í›„ <input type="number" id="bonus-condition-time" value="5" class="w-16 text-center mx-1 border-b">ì´ˆ ì•ˆì— ë„˜ê¸°ë©´ ì¶”ê°€ ì‹œê°„ <input type="number" id="bonus-reward-time" value="3" class="w-16 text-center mx-1 border-b">ì´ˆ íšë“!
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-8 text-center">
                <button id="start-timer-btn" class="bg-green-500 text-white px-10 py-3 rounded-lg font-bold text-lg hover:bg-green-600 shadow-lg disabled:bg-slate-400 disabled:cursor-not-allowed" data-i18n="startGameButton">ê²Œì„ ì‹œì‘</button>
            </div>
        </div>

        <!-- íƒ€ì´ë¨¸ ë·° -->
        <div id="timer-view" class="hidden relative">
            <!-- ìŒì†Œê±° ë²„íŠ¼ -->
            <button id="mute-btn" class="absolute top-4 right-4 z-10 p-2 bg-white rounded-full shadow-md">
                <svg id="volume-icon" class="w-6 h-6 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path></svg>
                <svg id="mute-icon" class="w-6 h-6 text-slate-600 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15zM17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"></path></svg>
            </button>
            <!-- ë³´ë„ˆìŠ¤ ì•Œë¦¼ -->
            <div id="notification" class="absolute top-1/3 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-yellow-300 text-yellow-800 font-bold px-6 py-3 rounded-full shadow-lg opacity-0 transform scale-50 z-20"></div>

            <div class="grid lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-lg flex flex-col items-center justify-center text-center">
                    <h2 id="current-user-name" class="text-4xl font-bold mb-2">í”Œë ˆì´ì–´ ì´ë¦„</h2>
                    <p class="text-slate-500 mb-6" data-i18n="turnSuffix">'s turn</p>
                    
                    <div class="relative w-64 h-64 sm:w-80 sm:h-80 mb-6 timer-ring-container">
                        <svg class="w-full h-full" viewBox="0 0 100 100">
                            <circle class="text-slate-200" stroke-width="8" stroke="currentColor" fill="transparent" r="45" cx="50" cy="50" />
                            <circle id="timer-progress-ring" stroke-width="8" stroke="currentColor" fill="transparent" r="45" cx="50" cy="50" stroke-linecap="round" transform="rotate(-90 50 50)" style="stroke-dasharray: 282.7; stroke-dashoffset: 282.7;" />
                        </svg>
                        <div id="timer-display-container" class="absolute inset-0 flex flex-col items-center justify-center">
                            <span id="timer-display" class="font-bold">00:00</span>
                            <span id="extra-time-indicator" class="text-amber-500 font-bold text-lg hidden" data-i18n="extraTimeIndicator">ì¶”ê°€ ì‹œê°„ ì‚¬ìš© ì¤‘</span>
                        </div>
                    </div>
                    
                    <div id="user-extra-time-display" class="mb-6 text-lg"><span data-i18n="extraTimeRemaining">ë‚¨ì€ ì¶”ê°€ ì‹œê°„:</span> <span id="current-user-extra-time" class="font-bold">0</span><span data-i18n="unitSec">ì´ˆ</span></div>

                    <div class="w-full px-4 sm:px-0 sm:max-w-xs sm:mx-auto">
                        <button id="next-turn-btn" class="w-full bg-amber-500 text-white px-6 py-4 rounded-lg font-bold text-lg hover:bg-amber-600 shadow-md" data-i18n="nextTurnButton">ì°¨ë¡€ ë„˜ê¸°ê¸°</button>
                        <button id="start-turn-btn" class="w-full bg-blue-500 text-white px-6 py-4 rounded-lg font-bold text-lg hover:bg-blue-600 shadow-md hidden" data-i18n="startButton">ì‹œì‘</button>
                    </div>
                </div>

                <div class="space-y-6">
                    <div class="bg-white p-6 rounded-2xl shadow-lg">
                        <h3 class="text-2xl font-bold mb-2 text-center" data-i18n="leaderboardTitle">ë¦¬ë”ë³´ë“œ</h3>
                        <p class="text-center text-sm text-slate-500 mb-4" data-i18n="leaderboardDesc">ìˆœì„œ ë³€ê²½(â–²/â–¼) / ê¸°ë¡ ë³´ê¸°(í´ë¦­)</p>
                        <div id="leaderboard" class="space-y-3 max-h-80 overflow-y-auto pr-2"></div>
                    </div>

                    <!-- ìƒì„¸ ë©íƒ€ì„ ë·° -->
                    <div id="lap-details-view" class="hidden bg-white p-6 rounded-2xl shadow-lg">
                        <h3 id="lap-details-title" class="text-xl font-bold mb-4 text-center"></h3>
                        <div id="lap-details-list" class="space-y-2 max-h-48 overflow-y-auto pr-2 text-center"></div>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-lg text-center">
                        <h3 class="text-2xl font-bold mb-4 text-center" data-i18n="controlPanelTitle">ì œì–´íŒ</h3>
                        <button id="end-game-btn" class="w-full bg-red-500 text-white px-6 py-3 rounded-lg font-bold hover:bg-red-600 shadow" data-i18n="endGameButton">ê²Œì„ ì¢…ë£Œ</button>
                    </div>
                </div>
            </div>
             <div id="total-time-container" class="mt-6 text-center text-xl font-semibold text-slate-600">
                <span data-i18n="totalTimeLabel">ì´ ì§„í–‰ ì‹œê°„:</span> <span id="total-game-time">00:00</span>
            </div>
        </div>
        
        <!-- ê²Œì„ ì¢…ë£Œ ëª¨ë‹¬ -->
        <div id="game-over-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
            <div class="bg-white text-center p-10 rounded-2xl shadow-2xl transform transition-all scale-95">
                <h2 class="text-5xl font-bold text-yellow-500 mb-4" data-i18n="victoryTitle">ğŸ† ìŠ¹ë¦¬ ğŸ†</h2>
                <p id="winner-name" class="text-3xl font-semibold text-slate-800 mb-8"></p>
                <button id="view-summary-btn" class="bg-blue-500 text-white px-8 py-3 rounded-lg font-bold text-lg hover:bg-blue-600" data-i18n="viewResultsButton">ê²°ê³¼ ë³´ê¸°</button>
            </div>
        </div>

        <!-- ë‹‰ë„¤ì„ ì¶”ì²œ ëª¨ë‹¬ -->
        <div id="nickname-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
            <div class="bg-white w-full max-w-md p-6 rounded-2xl shadow-xl">
                <h2 class="text-2xl font-bold text-center mb-4" data-i18n="playerSettingsTitle">í”Œë ˆì´ì–´ ì„¤ì •</h2>
                <p class="text-center text-slate-500 mb-6" data-i18n="playerSettingsDesc">ë‹‰ë„¤ì„ê³¼ ìƒ‰ìƒì„ ì„¤ì •í•´ì£¼ì„¸ìš”.</p>
                
                <div class="flex items-center justify-center gap-4 mb-6">
                    <label for="modal-user-color" class="font-medium text-slate-600" data-i18n="colorLabel">ìƒ‰ìƒ:</label>
                    <input type="color" id="modal-user-color" value="#3b82f6" title="ìƒ‰ìƒ ì„ íƒ">
                </div>

                <div class="flex items-center gap-2 mb-4">
                    <input type="text" id="modal-nickname-input" class="flex-grow w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" data-i18n-placeholder="nicknameInputHint">
                </div>
                <div id="nickname-suggestions" class="grid grid-cols-3 gap-2 mb-6">
                </div>
                 <p id="modal-error-msg" class="text-red-500 text-center text-sm mb-4 h-5"></p>
                <div class="flex gap-4">
                    <button id="modal-cancel-btn" class="w-full bg-slate-200 text-slate-700 px-6 py-2 rounded-lg font-semibold hover:bg-slate-300" data-i18n="cancelButton">ì·¨ì†Œ</button>
                    <button id="modal-confirm-btn" class="w-full bg-blue-500 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-600" data-i18n="confirmButton">í™•ì¸</button>
                </div>
            </div>
        </div>
        
        <!-- ì ìˆ˜ ì…ë ¥ ëª¨ë‹¬ -->
        <div id="score-input-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
            <div class="bg-white w-full max-w-md p-6 rounded-2xl shadow-xl">
                <h2 class="text-2xl font-bold text-center mb-4" data-i18n="scoreInputTitle">ì ìˆ˜ ì…ë ¥</h2>
                <p class="text-center text-slate-500 mb-6" data-i18n="scoreInputDesc">ê° í”Œë ˆì´ì–´ì˜ ìµœì¢… ì ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>
                <div id="score-input-list" class="space-y-4 max-h-80 overflow-y-auto pr-2 mb-6">
                    <!-- ì ìˆ˜ ì…ë ¥ í•„ë“œê°€ ì—¬ê¸°ì— ì‚½ì…ë©ë‹ˆë‹¤ -->
                </div>
                <button id="show-summary-from-scores-btn" class="w-full bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-600" data-i18n="viewResultsButton">ê²°ê³¼ ë³´ê¸°</button>
            </div>
        </div>

        <!-- ìµœì¢… ê²°ê³¼ ëª¨ë‹¬ -->
        <div id="summary-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4">
            <div class="w-full max-w-lg">
                <div id="summary-content" class="bg-white p-8 rounded-2xl shadow-2xl">
                    <h2 id="summary-game-name" class="text-4xl font-bold text-center mb-2">ê²Œì„ ê²°ê³¼</h2>
                    <p class="text-center text-slate-500 mb-6"><span data-i18n="totalTimeLabel">ì´ ì§„í–‰ ì‹œê°„:</span> <span id="summary-total-time" class="font-semibold"></span></p>
                    <div id="summary-player-list" class="space-y-3 max-h-80 overflow-y-auto pr-2 border-t pt-4">
                        <!-- í”Œë ˆì´ì–´ ê²°ê³¼ ëª©ë¡ -->
                    </div>
                </div>
                <div class="mt-6 flex gap-4">
                    <button id="reset-game-btn" class="w-full bg-blue-500 text-white px-6 py-3 rounded-lg font-bold hover:bg-blue-600" data-i18n="newGameButton">ìƒˆ ê²Œì„ ì‹œì‘</button>
                    <button id="save-image-btn" class="w-full bg-green-500 text-white px-6 py-3 rounded-lg font-bold hover:bg-green-600" data-i18n="saveAsImageButton">ì´ë¯¸ì§€ë¡œ ì €ì¥</button>
                </div>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- ë‹¤êµ­ì–´ ì²˜ë¦¬ ---
            const translations = {
                en: {
                    settingsTitle: "Game Timer Settings", gameNameLabel: "Game Name", gameNameHint: "What is today's game?", addPlayerTitle: "1. Add Players", playerNameHint: "Player Name (1-100)", addButton: "Add", timeSettingsTitle: "2. Time Settings", baseTimeLabel: "Base Time", extraTimeLabel: "Extra Time", unitSec: "sec", unitMin: "min", gameModeTitle: "3. Game Mode Settings", suddenDeathLabel: "Enable Sudden Death Mode", quickTurnBonusLabel: "Quick Turn Bonus", quickTurnBonusDesc: 'Get +<input type="number" id="bonus-reward-time" value="3" class="w-16 text-center mx-1 border-b">s bonus for passing within <input type="number" id="bonus-condition-time" value="5" class="w-16 text-center mx-1 border-b">s!', startGameButton: "Start Game", turnSuffix: "'s turn", extraTimeIndicator: "Using Extra Time", extraTimeRemaining: "Extra time left:", nextTurnButton: "Next Turn", startButton: "Start", leaderboardTitle: "Leaderboard", leaderboardDesc: "Change order (â–²/â–¼) / View records (Click)", controlPanelTitle: "Control Panel", endGameButton: "End Game", totalTimeLabel: "Total Time:", victoryTitle: "ğŸ† VICTORY ğŸ†", viewResultsButton: "View Results", playerSettingsTitle: "Player Settings", playerSettingsDesc: "Set nickname and color.", colorLabel: "Color:", nicknameInputHint: "Enter desired nickname", cancelButton: "Cancel", confirmButton: "Confirm", scoreInputTitle: "Enter Scores", scoreInputDesc: "Enter the final score for each player.", newGameButton: "New Game", saveAsImageButton: "Save as Image", alertNameExists: "This name is already taken.", alertColorExists: "This color is already taken.", alertMaxPlayers: "A maximum of 100 players can be added.", alertNicknameRequired: "Please enter or select a nickname.", notificationBonus: "+{time}s Bonus!", notificationEliminated: "{name} eliminated!", detailsTitle: "{name} - Detailed Records", detailsNoRecords: "No records yet.",
                },
                de: {
                    settingsTitle: "Spiel-Timer-Einstellungen", gameNameLabel: "Spielname", gameNameHint: "Was ist das heutige Spiel?", addPlayerTitle: "1. Spieler hinzufÃ¼gen", playerNameHint: "Spielername (1-100)", addButton: "Hinzuf.", timeSettingsTitle: "2. Zeiteinstellungen", baseTimeLabel: "Basiszeit", extraTimeLabel: "Extrazeit", unitSec: "sek", unitMin: "min", gameModeTitle: "3. Spielmodus-Einstellungen", suddenDeathLabel: "Sudden-Death-Modus aktivieren", quickTurnBonusLabel: "Schnellzug-Bonus", quickTurnBonusDesc: 'Erhalte +<input type="number" id="bonus-reward-time" value="3" class="w-16 text-center mx-1 border-b">s Bonus bei Zug innerhalb von <input type="number" id="bonus-condition-time" value="5" class="w-16 text-center mx-1 border-b">s!', startGameButton: "Spiel starten", turnSuffix: " ist dran", extraTimeIndicator: "Extrazeit wird genutzt", extraTimeRemaining: "Verbleibende Extrazeit:", nextTurnButton: "NÃ¤chster Zug", startButton: "Start", leaderboardTitle: "Rangliste", leaderboardDesc: "Reihenfolge Ã¤ndern (â–²/â–¼) / Details (Klick)", controlPanelTitle: "Steuerung", endGameButton: "Spiel beenden", totalTimeLabel: "Gesamtzeit:", victoryTitle: "ğŸ† SIEG ğŸ†", viewResultsButton: "Ergebnisse ansehen", playerSettingsTitle: "Spieler-Einstellungen", playerSettingsDesc: "Spitznamen und Farbe festlegen.", colorLabel: "Farbe:", nicknameInputHint: "Wunschnamen eingeben", cancelButton: "Abbrechen", confirmButton: "BestÃ¤tigen", scoreInputTitle: "Punkte eingeben", scoreInputDesc: "Gib die Endpunktzahl fÃ¼r jeden Spieler ein.", newGameButton: "Neues Spiel", saveAsImageButton: "Als Bild speichern", alertNameExists: "Dieser Name ist bereits vergeben.", alertColorExists: "Diese Farbe ist bereits vergeben.", alertMaxPlayers: "Maximal 100 Spieler kÃ¶nnen hinzugefÃ¼gt werden.", alertNicknameRequired: "Bitte gib einen Spitznamen ein oder wÃ¤hle einen aus.", notificationBonus: "+{time}s Bonus!", notificationEliminated: "{name} ist ausgeschieden!", detailsTitle: "{name} - Detaillierte Aufzeichnungen", detailsNoRecords: "Noch keine Aufzeichnungen.",
                },
                es: {
                    settingsTitle: "Ajustes del Temporizador", gameNameLabel: "Nombre del Juego", gameNameHint: "Â¿CuÃ¡l es el juego de hoy?", addPlayerTitle: "1. AÃ±adir Jugadores", playerNameHint: "Nombre (1-100)", addButton: "AÃ±adir", timeSettingsTitle: "2. Ajustes de Tiempo", baseTimeLabel: "Tiempo Base", extraTimeLabel: "Tiempo Extra", unitSec: "seg", unitMin: "min", gameModeTitle: "3. Ajustes de Modo de Juego", suddenDeathLabel: "Activar Modo Muerte SÃºbita", quickTurnBonusLabel: "Bono de Turno RÃ¡pido", quickTurnBonusDesc: 'Â¡ObtÃ©n +<input type="number" id="bonus-reward-time" value="3" class="w-16 text-center mx-1 border-b">s extra por pasar en <input type="number" id="bonus-condition-time" value="5" class="w-16 text-center mx-1 border-b">s!', startGameButton: "Iniciar Juego", turnSuffix: " - tu turno", extraTimeIndicator: "Usando Tiempo Extra", extraTimeRemaining: "Tiempo extra restante:", nextTurnButton: "Siguiente Turno", startButton: "Iniciar", leaderboardTitle: "ClasificaciÃ³n", leaderboardDesc: "Cambiar orden (â–²/â–¼) / Ver rÃ©cords (Clic)", controlPanelTitle: "Panel de Control", endGameButton: "Terminar Juego", totalTimeLabel: "Tiempo Total:", victoryTitle: "ğŸ† VICTORIA ğŸ†", viewResultsButton: "Ver Resultados", playerSettingsTitle: "Ajustes de Jugador", playerSettingsDesc: "Elige apodo y color.", colorLabel: "Color:", nicknameInputHint: "Introduce el apodo deseado", cancelButton: "Cancelar", confirmButton: "Confirmar", scoreInputTitle: "Introducir Puntuaciones", scoreInputDesc: "Introduce la puntuaciÃ³n final de cada jugador.", newGameButton: "Nuevo Juego", saveAsImageButton: "Guardar como Imagen", alertNameExists: "Este nombre ya estÃ¡ en uso.", alertColorExists: "Este color ya estÃ¡ en uso.", alertMaxPlayers: "Se puede aÃ±adir un mÃ¡ximo de 100 jugadores.", alertNicknameRequired: "Por favor, introduce o selecciona un apodo.", notificationBonus: "Â¡+{time}s de Bono!", notificationEliminated: "Â¡{name} ha sido eliminado!", detailsTitle: "{name} - Registros Detallados", detailsNoRecords: "AÃºn no hay registros.",
                },
                ko: {
                    settingsTitle: "ê²Œì„ íƒ€ì´ë¨¸ ì„¤ì •", gameNameLabel: "ê²Œì„ ì´ë¦„", gameNameHint: "ì˜¤ëŠ˜ì˜ ê²Œì„ ì´ë¦„ì€?", addPlayerTitle: "1. í”Œë ˆì´ì–´ ì¶”ê°€", playerNameHint: "í”Œë ˆì´ì–´ ì´ë¦„ (1-100ëª…)", addButton: "ì¶”ê°€", timeSettingsTitle: "2. ì‹œê°„ ì„¤ì •", baseTimeLabel: "ê¸°ë³¸ ì‹œê°„", extraTimeLabel: "ì¶”ê°€ ì‹œê°„", unitSec: "ì´ˆ", unitMin: "ë¶„", gameModeTitle: "3. ê²Œì„ ëª¨ë“œ ì„¤ì •", suddenDeathLabel: "ì„œë“ ë°ìŠ¤ ëª¨ë“œ í™œì„±í™”", quickTurnBonusLabel: "í€µ í„´ ë³´ë„ˆìŠ¤", quickTurnBonusDesc: 'í„´ ì‹œì‘ í›„ <input type="number" id="bonus-condition-time" value="5" class="w-16 text-center mx-1 border-b">ì´ˆ ì•ˆì— ë„˜ê¸°ë©´ ì¶”ê°€ ì‹œê°„ <input type="number" id="bonus-reward-time" value="3" class="w-16 text-center mx-1 border-b">ì´ˆ íšë“!', startGameButton: "ê²Œì„ ì‹œì‘", turnSuffix: "ë‹˜ì˜ ì°¨ë¡€ì…ë‹ˆë‹¤", extraTimeIndicator: "ì¶”ê°€ ì‹œê°„ ì‚¬ìš© ì¤‘", extraTimeRemaining: "ë‚¨ì€ ì¶”ê°€ ì‹œê°„:", nextTurnButton: "ì°¨ë¡€ ë„˜ê¸°ê¸°", startButton: "ì‹œì‘", leaderboardTitle: "ë¦¬ë”ë³´ë“œ", leaderboardDesc: "ìˆœì„œ ë³€ê²½(â–²/â–¼) / ê¸°ë¡ ë³´ê¸°(í´ë¦­)", controlPanelTitle: "ì œì–´íŒ", endGameButton: "ê²Œì„ ì¢…ë£Œ", totalTimeLabel: "ì´ ì§„í–‰ ì‹œê°„:", victoryTitle: "ğŸ† ìŠ¹ë¦¬ ğŸ†", viewResultsButton: "ê²°ê³¼ ë³´ê¸°", playerSettingsTitle: "í”Œë ˆì´ì–´ ì„¤ì •", playerSettingsDesc: "ë‹‰ë„¤ì„ê³¼ ìƒ‰ìƒì„ ì„¤ì •í•´ì£¼ì„¸ìš”.", colorLabel: "ìƒ‰ìƒ:", nicknameInputHint: "ì›í•˜ëŠ” ë‹‰ë„¤ì„ ì…ë ¥", cancelButton: "ì·¨ì†Œ", confirmButton: "í™•ì¸", scoreInputTitle: "ì ìˆ˜ ì…ë ¥", scoreInputDesc: "ê° í”Œë ˆì´ì–´ì˜ ìµœì¢… ì ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.", newGameButton: "ìƒˆ ê²Œì„ ì‹œì‘", saveAsImageButton: "ì´ë¯¸ì§€ë¡œ ì €ì¥", alertNameExists: "ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ë‹‰ë„¤ì„ì…ë‹ˆë‹¤.", alertColorExists: "ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ìƒ‰ìƒì…ë‹ˆë‹¤.", alertMaxPlayers: "í”Œë ˆì´ì–´ëŠ” ìµœëŒ€ 100ëª…ê¹Œì§€ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.", alertNicknameRequired: "ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ê±°ë‚˜ ì„ íƒí•´ì£¼ì„¸ìš”.", notificationBonus: "+{time}ì´ˆ ë³´ë„ˆìŠ¤!", notificationEliminated: "{name}ë‹˜ íƒˆë½!", detailsTitle: "{name} - ìƒì„¸ ê¸°ë¡", detailsNoRecords: "ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.",
                }
            };

            function getLanguage() {
                const lang = navigator.language.split('-')[0];
                return translations[lang] ? lang : 'en'; // ê¸°ë³¸ê°’ ì˜ì–´
            }

            function applyTranslations(lang) {
                const t = translations[lang];
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.dataset.i18n;
                    if (t[key]) {
                        if (key === 'quickTurnBonusDesc') {
                             const conditionTime = document.getElementById('bonus-condition-time').value;
                             const rewardTime = document.getElementById('bonus-reward-time').value;
                             el.innerHTML = t[key].replace('value="5"', `value="${conditionTime}"`).replace('value="3"', `value="${rewardTime}"`);
                        } else {
                            el.innerHTML = t[key];
                        }
                    }
                });
                document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                    const key = el.dataset.i18nPlaceholder;
                    if (t[key]) el.placeholder = t[key];
                });
                document.title = lang === 'ko' ? 'ê²Œì„ ëª¨ë“œ íƒ€ì´ë¨¸' : 'Game Mode Timer';
            }
            
            const currentLang = getLanguage();
            applyTranslations(currentLang);
            
            // --- UI ìš”ì†Œ ---
            // ... (ì´ì „ ì½”ë“œì™€ ë™ì¼)

            // --- ë‚˜ë¨¸ì§€ ìŠ¤í¬ë¦½íŠ¸ ë¡œì§ ---
            // ... (ì´ì „ ì½”ë“œì™€ ë™ì¼, ë‹¨ alert ë©”ì‹œì§€ì™€ notification ë©”ì‹œì§€ëŠ” ë‹¤êµ­ì–´ ì²˜ë¦¬ í•„ìš”)
            
            // ì˜ˆì‹œ: ì•Œë¦¼ ë©”ì‹œì§€ ë‹¤êµ­ì–´ ì²˜ë¦¬
            function showNotification(messageKey, options = {}) {
                let message = translations[currentLang][messageKey] || messageKey;
                for (const key in options) {
                    message = message.replace(`{${key}}`, options[key]);
                }
                // ... showNotification ë¡œì§
            }
        });
    </script>
</body>
</html>