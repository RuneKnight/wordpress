<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë ˆë²¨ì—…! ì–´ë¦°ì´ ì›ì†Œ íƒí—˜ëŒ€</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Gowun Dodum', sans-serif;
            background-color: #FFFBEB; /* Light Cream */
            color: #262626; /* Soft Black */
        }
        .periodic-table {
            display: grid;
            grid-template-columns: repeat(18, minmax(0, 1fr));
            gap: 4px;
        }
        .element-cell {
            grid-column: span 1;
            transition: all 0.3s ease-in-out;
            aspect-ratio: 1 / 1;
            border-radius: 0.5rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border: 2px solid transparent;
        }
        .element-cell.locked {
            opacity: 0.15;
            filter: grayscale(100%);
            cursor: not-allowed;
            transform: scale(0.95);
        }
        .element-cell:not(.locked):hover {
            transform: scale(1.1);
            z-index: 10;
        }
        .element-cell.selected {
            transform: scale(1.15) !important;
            box-shadow: 0 0 0 4px #FB923C; /* Orange-400 */
            z-index: 20;
            border-color: #FB923C;
        }
        .group-metal { background-color: #7DD3FC; }
        .group-gas { background-color: #FCD34D; }
        .group-life { background-color: #86EFAC; }
        .group-special { background-color: #F472B6; }
        .group-unknown { background-color: #E5E7EB; }
        
        .highlight {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(251, 146, 60, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(251, 146, 60, 0); }
            100% { box-shadow: 0 0 0 0 rgba(251, 146, 60, 0); }
        }
        .dimmed {
            opacity: 0.3;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 45vh;
        }
        .content-card {
            background-color: #ffffff;
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .level-btn, .filter-btn {
            transition: all 0.2s;
            border-radius: 9999px;
            padding: 0.5rem 1rem;
            font-weight: 600;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .level-btn:hover, .filter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .level-btn-active, .filter-btn-active {
            transform: translateY(1px);
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);
            background-color: #F97316 !important; /* Orange-500 */
            color: white !important;
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-6">
            <h1 class="text-5xl font-bold text-amber-600" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.1);">ë ˆë²¨ì—…! ì–´ë¦°ì´ ì›ì†Œ íƒí—˜ëŒ€</h1>
            <p class="mt-3 text-xl text-slate-700">ë ˆë²¨ì„ ê³¨ë¼ ì‹ ê¸°í•œ ì›ì†Œ ì¹œêµ¬ë“¤ì„ ë§Œë‚˜ë³´ì•„ìš”!</p>
        </header>
        
        <div class="content-card mb-6">
            <h3 class="font-bold text-2xl mb-3 text-center text-orange-500">ë ˆë²¨ ì„ íƒ</h3>
            <div class="flex flex-wrap gap-3 justify-center" id="level-selector">
                <button data-level="1" class="level-btn bg-green-400 text-white">ğŸŒ± ì”¨ì•— ë ˆë²¨</button>
                <button data-level="2" class="level-btn bg-sky-400 text-white">ğŸŒ¿ ìƒˆì‹¹ ë ˆë²¨</button>
                <button data-level="3" class="level-btn bg-red-400 text-white">ğŸŒ³ ë‚˜ë¬´ ë ˆë²¨</button>
            </div>
        </div>

        <main class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2">
                <div class="content-card mb-4">
                    <h3 class="font-bold text-2xl mb-3 text-center text-pink-500">ì¬ë¯¸ìˆëŠ” ë¬¶ì–´ë³´ê¸°</h3>
                    <div class="flex flex-wrap gap-3 justify-center" id="theme-filters">
                        <button data-theme="all" class="filter-btn bg-slate-300 text-slate-800">ëª¨ë“  ì¹œêµ¬ë“¤</button>
                        <button data-theme="metal" class="filter-btn bg-slate-300 text-slate-800">ë°˜ì§ë°˜ì§ ê¸ˆì†</button>
                        <button data-theme="gas" class="filter-btn bg-slate-300 text-slate-800">ë‘¥ì‹¤ë‘¥ì‹¤ ê³µê¸°</button>
                        <button data-theme="life" class="filter-btn bg-slate-300 text-slate-800">ìš°ë¦¬ ëª¸ êµ¬ì„±</button>
                        <button data-theme="tech" class="filter-btn bg-slate-300 text-slate-800">ìŠ¤ë§ˆíŠ¸í° ì†</button>
                    </div>
                </div>

                <div id="periodic-table-container" class="periodic-table p-2 sm:p-4">
                    <!-- Elements will be generated by JS -->
                </div>
            </div>

            <div id="content-display" class="lg:col-span-1">
                <div id="welcome-content" class="content-card min-h-[400px] flex flex-col justify-center items-center text-center">
                     <div id="welcome-icon" class="text-6xl mb-4">ğŸŒ±</div>
                     <h3 id="welcome-title" class="text-2xl font-bold text-slate-800">ì”¨ì•— ë ˆë²¨ì— ì˜¨ ê±¸ í™˜ì˜í•´!</h3>
                    <p id="welcome-text" class="mt-2 text-slate-600">ì™¼ìª½ í‘œì—ì„œ ê¶ê¸ˆí•œ ì›ì†Œ ì¹œêµ¬ë¥¼ ì½•! ëˆŒëŸ¬ì£¼ë©´, ê·¸ ì¹œêµ¬ê°€ ìê¸°ë¥¼ ì†Œê°œí•´ ì¤„ ê±°ì•¼.</p>
                </div>
                <div id="element-content" tabindex="-1" class="hidden content-card min-h-[400px] outline-none focus:ring-4 focus:ring-orange-400 focus:ring-offset-2"></div>
            </div>
        </main>
        
        <section id="comparison-section" class="mt-8 content-card">
            <h2 class="text-3xl font-bold text-center mb-2 text-orange-500">ëˆ„ê°€ëˆ„ê°€ ë” ë¬´ê±°ìš¸ê¹Œ?</h2>
            <p class="text-center text-slate-600 mb-6">ì›ì†Œ ì¹œêµ¬ë“¤ì˜ ëª¸ë¬´ê²Œë¥¼ ë¹„êµí•´ë´ìš”! ì•„ë˜ì—ì„œ ë³´ê³  ì‹¶ì€ ê·¸ë£¹ì„ ì„ íƒí•˜ì„¸ìš”.</p>
            <div class="flex justify-center mb-6">
                <select id="comparison-group-select" class="p-3 border-2 border-slate-300 rounded-lg bg-white shadow-sm text-lg focus:ring-2 focus:ring-blue-500">
                </select>
            </div>
            <div class="chart-container">
                <canvas id="comparison-chart"></canvas>
            </div>
        </section>
    </div>

    <script>
        const allElementsData = [
            { number: 1, symbol: 'H', name: 'ìˆ˜ì†Œ', mass: 1, group: 'gas', theme: ['life', 'gas'], level: 1 },
            { number: 2, symbol: 'He', name: 'í—¬ë¥¨', mass: 4, group: 'gas', theme: ['gas'], level: 2 },
            { number: 3, symbol: 'Li', name: 'ë¦¬íŠ¬', mass: 7, group: 'metal', theme: ['tech'], level: 2 },
            { number: 4, symbol: 'Be', name: 'ë² ë¦´ë¥¨', mass: 9, group: 'metal', level: 3 },
            { number: 5, symbol: 'B', name: 'ë¶•ì†Œ', mass: 11, group: 'special', theme: ['tech'], level: 3 },
            { number: 6, symbol: 'C', name: 'íƒ„ì†Œ', mass: 12, group: 'life', theme: ['life'], level: 1 },
            { number: 7, symbol: 'N', name: 'ì§ˆì†Œ', mass: 14, group: 'gas', theme: ['life', 'gas'], level: 1 },
            { number: 8, symbol: 'O', name: 'ì‚°ì†Œ', mass: 16, group: 'gas', theme: ['life', 'gas'], level: 1 },
            { number: 9, symbol: 'F', name: 'í”Œë£¨ì˜¤ë¦°', mass: 19, group: 'gas', level: 3 },
            { number: 10, symbol: 'Ne', name: 'ë„¤ì˜¨', mass: 20, group: 'gas', theme: ['gas'], level: 2 },
            { number: 11, symbol: 'Na', name: 'ë‚˜íŠ¸ë¥¨', mass: 23, group: 'metal', theme: ['life'], level: 2 },
            { number: 12, symbol: 'Mg', name: 'ë§ˆê·¸ë„¤ìŠ˜', mass: 24, group: 'metal', theme: ['life'], level: 2 },
            { number: 13, symbol: 'Al', name: 'ì•Œë£¨ë¯¸ëŠ„', mass: 27, group: 'metal', theme: ['metal'], level: 2 },
            { number: 14, symbol: 'Si', name: 'ê·œì†Œ', mass: 28, group: 'special', theme: ['tech'], level: 1 },
            { number: 15, symbol: 'P', name: 'ì¸', mass: 31, group: 'life', theme: ['life'], level: 2 },
            { number: 16, symbol: 'S', name: 'í™©', mass: 32, group: 'life', theme: ['life'], level: 2 },
            { number: 17, symbol: 'Cl', name: 'ì—¼ì†Œ', mass: 35, group: 'gas', level: 3 },
            { number: 18, symbol: 'Ar', name: 'ì•„ë¥´ê³¤', mass: 40, group: 'gas', theme: ['gas'], level: 3 },
            { number: 19, symbol: 'K', name: 'ì¹¼ë¥¨', mass: 39, group: 'metal', theme: ['life'], level: 2 },
            { number: 20, symbol: 'Ca', name: 'ì¹¼ìŠ˜', mass: 40, group: 'metal', theme: ['life'], level: 1 },
            { number: 26, symbol: 'Fe', name: 'ì² ', mass: 56, group: 'metal', theme: ['life', 'metal'], level: 1 },
            { number: 29, symbol: 'Cu', name: 'êµ¬ë¦¬', mass: 64, group: 'metal', theme: ['metal', 'tech'], level: 1 },
            { number: 47, symbol: 'Ag', name: 'ì€', mass: 108, group: 'metal', theme: ['metal'], level: 2 },
            { number: 50, symbol: 'Sn', name: 'ì£¼ì„', mass: 119, group: 'metal', theme: ['tech'], level: 2 },
            { number: 79, symbol: 'Au', name: 'ê¸ˆ', mass: 197, group: 'metal', theme: ['metal', 'tech'], level: 1 },
            { number: 80, symbol: 'Hg', name: 'ìˆ˜ì€', mass: 201, group: 'metal', level: 3 },
            { number: 82, symbol: 'Pb', name: 'ë‚©', mass: 207, group: 'metal', level: 3 },
            { number: 92, symbol: 'U', name: 'ìš°ë¼ëŠ„', mass: 238, group: 'special', level: 3 },
        ];
        
        const contentData = {
            'H': { 1: { intro: "ì•ˆë…•! ë‚˜ëŠ” ìš°ì£¼ ëŒ€ì¥, ìˆ˜ì†Œì•¼!", uses: [{ i: 'â˜€ï¸', t: 'íƒœì–‘ì„ ë¹›ë‚˜ê²Œ í•´' }, { i: 'ğŸ’§', t: 'ë¬¼ì´ ë˜ëŠ” ì¬ë£Œì•¼' }] }, 2: { intro: "ë‚˜ëŠ” ìˆ˜ì†Œ! ì œì¼ ê°€ë²¼ìš´ ê³µê¸° ì¹œêµ¬ì§€.", uses: [{ i: 'â˜€ï¸', t: 'íƒœì–‘ì˜ ì—°ë£Œ' }, { i: 'ğŸ’§', t: 'ë¬¼(Hâ‚‚O)ì˜ êµ¬ì„±ì›' }, { i: 'ğŸš€', t: 'ë¡œì¼“ ì—°ë£Œ' }] }, 3: { intro: "ë‚˜ëŠ” ì›ìë²ˆí˜¸ 1ë²ˆ, ìˆ˜ì†Œ(H)ì•¼.", uses: [{ i: 'âš–ï¸', t: 'ëª¸ë¬´ê²Œ: 1' }, { i: 'ğŸ”¥', t: 'ê¹¨ë—í•œ ì—ë„ˆì§€ì›' }, { i: 'âš›ï¸', t: 'ëª¨ë“  ì›ì†Œì˜ ì‹œì‘' }] } },
            'C': { 1: { intro: "ë‚˜ëŠ” íƒ„ì†Œ! ë„ˆë‘ ë‚˜ë¥¼ ë§Œë“œëŠ” ì¬ë£Œì•¼.", uses: [{ i: 'âœï¸', t: 'ì—°í•„ì‹¬' }, { i: 'ğŸ’', t: 'ë‹¤ì´ì•„ëª¬ë“œ' }] }, 2: { intro: "ë‚˜ëŠ” íƒ„ì†Œ! ìƒëª…ì²´ì˜ ê¸°ë³¸ ì¬ë£Œì•¼.", uses: [{ i: 'âœï¸', t: 'ì—°í•„ì‹¬(í‘ì—°)' }, { i: 'ğŸ’', t: 'ë‹¤ì´ì•„ëª¬ë“œ' }, { i: 'ğŸ§‘', t: 'ìš°ë¦¬ ëª¸ì˜ êµ¬ì„±ì›' }] }, 3: { intro: "ë‚˜ëŠ” ì›ìë²ˆí˜¸ 6ë²ˆ, íƒ„ì†Œ(C)ì•¼.", uses: [{ i: 'âš–ï¸', t: 'ëª¸ë¬´ê²Œ: 12' }, { i: 'ğŸ”—', t: 'ë‹¤ì–‘í•œ ì›ì†Œì™€ ê²°í•©' }, { i: 'ğŸŒ¿', t: 'ìœ ê¸°ë¬¼ì˜ ë¼ˆëŒ€' }] } },
            'O': { 1: { intro: "ë‚˜ëŠ” ì‚°ì†Œ! ë„¤ê°€ ìˆ¨ ì‰´ ë•Œë§ˆë‹¤ ë‚´ê°€ í•„ìš”í•´.", uses: [{ i: 'ğŸ˜®', t: 'ìˆ¨ ì‰´ ë•Œ í•„ìš”í•´' }, { i: 'ğŸ”¥', t: 'ë¶ˆì„ í™œí™œ íƒ€ê²Œ í•´' }] }, 2: { intro: "ë‚˜ëŠ” ì‚°ì†Œ! ì—†ìœ¼ë©´ ì‚´ ìˆ˜ ì—†ëŠ” ì¤‘ìš”í•œ ê³µê¸°ì•¼.", uses: [{ i: 'ğŸ˜®', t: 'í˜¸í¡ì— í•„ìˆ˜' }, { i: 'ğŸ’§', t: 'ë¬¼ì˜ êµ¬ì„±ì›' }, { i: 'ğŸŒ', t: 'ì§€êµ¬ ëŒ€ê¸°ì˜ 21%' }] }, 3: { intro: "ë‚˜ëŠ” ì›ìë²ˆí˜¸ 8ë²ˆ, ì‚°ì†Œ(O)ì•¼.", uses: [{ i: 'âš–ï¸', t: 'ëª¸ë¬´ê²Œ: 16' }, { i: 'âš¡', t: 'ê°•ë ¥í•œ ì‚°í™”ì œ' }, { i: 'ğŸ¥', t: 'ì˜ë£Œìš©ìœ¼ë¡œ ì‚¬ìš©' }] } },
            'Fe': { 1: { intro: "ë‚˜ëŠ” ì² ! íŠ¼íŠ¼í•´ì„œ ìë™ì°¨ë‘ ê±´ë¬¼ì„ ë§Œë“¤ì–´.", uses: [{ i: 'ğŸš—', t: 'ìë™ì°¨ ë¼ˆëŒ€' }, { i: 'ğŸ©¸', t: 'ìš°ë¦¬ í”¼ë¥¼ ë¹¨ê°›ê²Œ í•´' }] }, 2: { intro: "ë‚˜ëŠ” ì² ! ì‚°ì—…ì˜ ìŒ€ì´ë¼ê³  ë¶ˆë¦´ ë§Œí¼ ì¤‘ìš”í•´.", uses: [{ i: 'ğŸš—', t: 'ìë™ì°¨, ë‹¤ë¦¬, ê±´ë¬¼' }, { i: 'ğŸ©¸', t: 'í—¤ëª¨ê¸€ë¡œë¹ˆì˜ ì¤‘ì‹¬' }, { i: 'ğŸ§²', t: 'ìì„ì´ ë  ìˆ˜ ìˆì–´' }] }, 3: { intro: "ë‚˜ëŠ” ì›ìë²ˆí˜¸ 26ë²ˆ, ì² (Fe)ì´ì•¼.", uses: [{ i: 'âš–ï¸', t: 'ëª¸ë¬´ê²Œ: 56' }, { i: 'ğŸ—ï¸', t: 'ê°€ì¥ ë§ì´ ì“°ëŠ” ê¸ˆì†' }, { i: 'ğŸŒ', t: 'ì§€êµ¬ í•µì˜ ì£¼ì„±ë¶„' }] } },
            'Au': { 1: { intro: "ë‚˜ëŠ” ê¸ˆ! ë°˜ì§ë°˜ì§ ë¹›ë‚˜ì„œ ëª¨ë‘ê°€ ë‚  ì¢‹ì•„í•´.", uses: [{ i: 'ğŸ¥‡', t: 'ê¸ˆë©”ë‹¬ì˜ ì£¼ì¸ê³µ' }, { i: 'ğŸ’', t: 'ì•„ë¦„ë‹¤ìš´ ë³´ì„' }] }, 2: { intro: "ë‚˜ëŠ” ê¸ˆ! ì•„ì£¼ ê·€í•˜ê³  ì˜ ë³€í•˜ì§€ ì•Šì•„.", uses: [{ i: 'ğŸ¥‡', t: '1ë“± ìƒì§•, ê¸ˆë©”ë‹¬' }, { i: 'ğŸ’', t: 'ì¥ì‹ êµ¬ ì¬ë£Œ' }, { i: 'ğŸ“±', t: 'ì²¨ë‹¨ ê¸°ê¸° ë¶€í’ˆ' }] }, 3: { intro: "ë‚˜ëŠ” ì›ìë²ˆí˜¸ 79ë²ˆ, ê¸ˆ(Au)ì´ì•¼.", uses: [{ i: 'âš–ï¸', t: 'ëª¸ë¬´ê²Œ: 197' }, { i: 'âœ¨', t: 'ë…¹ìŠ¬ì§€ ì•Šì•„' }, { i: 'ğŸ’°', t: 'ê·€ê¸ˆì†ì˜ ì™•' }] } },
        };

        let currentLevel = 1;
        let comparisonChart;

        document.addEventListener('DOMContentLoaded', () => {
            const container = document.querySelector('.container');
            if (!container) return;

            const tableContainer = container.querySelector('#periodic-table-container');
            const elementContentDiv = container.querySelector('#element-content');
            const welcomeContentDiv = container.querySelector('#welcome-content');
            
            function generatePeriodicTable() {
                const periodicLayout = [
                    {n:1, r:1, c:1}, {n:2, r:1, c:18},
                    {n:3, r:2, c:1}, {n:4, r:2, c:2}, {n:5, r:2, c:13}, {n:6, r:2, c:14}, {n:7, r:2, c:15}, {n:8, r:2, c:16}, {n:9, r:2, c:17}, {n:10, r:2, c:18},
                    {n:11, r:3, c:1}, {n:12, r:3, c:2}, {n:13, r:3, c:13}, {n:14, r:3, c:14}, {n:15, r:3, c:15}, {n:16, r:3, c:16}, {n:17, r:3, c:17}, {n:18, r:3, c:18},
                    {n:19, r:4, c:1}, {n:20, r:4, c:2}, {n:26, r:4, c:8}, {n:29, r:4, c:11},
                    {n:47, r:5, c:11}, {n:50, r:5, c:14},
                    {n:79, r:6, c:11}, {n:80, r:6, c:12}, {n:82, r:6, c:14},
                    {n:92, r:7, c:6} 
                ];
                
                tableContainer.innerHTML = '';
                allElementsData.forEach(el => {
                    const pos = periodicLayout.find(p => p.n === el.number);
                    if(!pos) return;

                    const isLocked = el.level > currentLevel;
                    const cell = document.createElement('div');
                    cell.id = `element-${el.number}`;
                    cell.className = `element-cell group-${el.group} ${isLocked ? 'locked' : ''}`;
                    cell.style.gridRow = pos.r;
                    cell.style.gridColumn = pos.c;
                    cell.dataset.number = el.number;
                    cell.innerHTML = `<div class="font-bold text-lg">${el.symbol}</div><div class="text-xs">${el.name}</div>`;
                    tableContainer.appendChild(cell);
                });
            }

            function showElementDetails(elementNumber) {
                const element = allElementsData.find(e => e.number == elementNumber);
                if (!element || element.level > currentLevel) return;
                
                container.querySelectorAll('.element-cell').forEach(cell => cell.classList.remove('selected'));
                container.querySelector(`#element-${element.number}`).classList.add('selected');

                const details = contentData[element.symbol] ? contentData[element.symbol][currentLevel] : { intro: `ì•ˆë…•! ë‚˜ëŠ” ${element.name}ì´ì•¼.`, uses: [{i:'âš–ï¸', t:`ëª¸ë¬´ê²Œ: ${element.mass}`}] };
                
                let usesHtml = details.uses.map(use => `<li class="flex items-center gap-3"><span class="text-2xl">${use.i}</span><span>${use.t}</span></li>`).join('');

                elementContentDiv.innerHTML = `
                    <div class="text-center">
                        <div class="text-7xl font-bold text-slate-800">${element.symbol}</div>
                        <h3 class="text-3xl font-bold mt-2">${element.name} #${element.number}</h3>
                        <p class="mt-4 text-lg bg-yellow-100 p-3 rounded-lg">${details.intro}</p>
                    </div>
                    <div class="mt-6">
                        <h4 class="font-bold text-xl text-pink-500">ì–´ë””ì— ì“°ì¼ê¹Œ?</h4>
                        <ul class="mt-2 space-y-2 text-lg">${usesHtml}</ul>
                    </div>
                `;
                welcomeContentDiv.classList.add('hidden');
                elementContentDiv.classList.remove('hidden');
                elementContentDiv.focus();
            }
            
            tableContainer.addEventListener('click', (e) => {
                const targetElement = e.target.closest('.element-cell');
                if (targetElement && !targetElement.classList.contains('locked') && targetElement.dataset.number) {
                    showElementDetails(targetElement.dataset.number);
                }
            });

            container.querySelector('#level-selector').addEventListener('click', e => {
                if(e.target.tagName !== 'BUTTON') return;
                currentLevel = parseInt(e.target.dataset.level);
                
                container.querySelectorAll('#level-selector button').forEach(btn => btn.classList.remove('level-btn-active'));
                e.target.classList.add('level-btn-active');
                
                const welcomeMessages = {
                    1: { icon: 'ğŸŒ±', title: 'ì”¨ì•— ë ˆë²¨ì— ì˜¨ ê±¸ í™˜ì˜í•´!', text: 'ê°€ì¥ ì¹œí•œ ì›ì†Œ ì¹œêµ¬ë“¤ì„ ë§Œë‚˜ë´!' },
                    2: { icon: 'ğŸŒ¿', title: 'ìƒˆì‹¹ ë ˆë²¨ë¡œ ë ˆë²¨ ì—…!', text: 'ë” ë§ì€ ì¹œêµ¬ë“¤ì´ ê¸°ë‹¤ë¦¬ê³  ìˆì–´!' },
                    3: { icon: 'ğŸŒ³', title: 'ë‚˜ë¬´ ë ˆë²¨! ì›ì†Œ ë°•ì‚¬ë‹˜!', text: 'ì´ì œ ëª¨ë“  ì›ì†Œ ì¹œêµ¬ë“¤ì„ ë§Œë‚  ìˆ˜ ìˆì–´!' }
                };
                container.querySelector('#welcome-icon').textContent = welcomeMessages[currentLevel].icon;
                container.querySelector('#welcome-title').textContent = welcomeMessages[currentLevel].title;
                container.querySelector('#welcome-text').textContent = welcomeMessages[currentLevel].text;
                
                welcomeContentDiv.classList.remove('hidden');
                elementContentDiv.classList.add('hidden');

                generatePeriodicTable();
                updateComparisonOptions();
                container.querySelector('#theme-filters button[data-theme="all"]').click();
            });

            container.querySelector('#theme-filters').addEventListener('click', e => {
                if(e.target.tagName !== 'BUTTON') return;
                const theme = e.target.dataset.theme;

                container.querySelectorAll('#theme-filters button').forEach(btn => btn.classList.remove('filter-btn-active'));
                e.target.classList.add('filter-btn-active');

                container.querySelectorAll('.element-cell:not(.locked)').forEach(cell => {
                    cell.classList.remove('dimmed', 'highlight');
                    const elNum = cell.dataset.number;
                    if (!elNum) return;

                    const element = allElementsData.find(e => e.number == elNum);
                    if (theme === 'all') { /* do nothing */ }
                    else if (theme === 'metal' && element.group === 'metal') { cell.classList.add('highlight'); }
                    else if (theme === 'gas' && element.group === 'gas') { cell.classList.add('highlight'); }
                    else if (element.theme && element.theme.includes(theme)) { cell.classList.add('highlight'); }
                    else { cell.classList.add('dimmed'); }
                });
            });

            function updateComparisonChart() {
                const selectEl = container.querySelector('#comparison-group-select');
                const group = selectEl.value;
                if (!group) return;

                const groupData = allElementsData.filter(el => el.level <= currentLevel && el.theme && el.theme.includes(group));
                groupData.sort((a, b) => a.mass - b.mass);

                const labels = groupData.map(el => el.name);
                const data = groupData.map(el => el.mass);
                const backgroundColors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40', '#C9CBCF'];

                if (comparisonChart) { comparisonChart.destroy(); }
                comparisonChart = new Chart(container.querySelector('#comparison-chart').getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'ëª¸ë¬´ê²Œ (ë¬´ê±°ì›€ì˜ ì •ë„)',
                            data: data,
                            backgroundColor: labels.map((_, i) => backgroundColors[i % backgroundColors.length]),
                        }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false, indexAxis: 'y',
                        plugins: { legend: { display: false }, title: { display: true, text: `'${selectEl.options[selectEl.selectedIndex].text}' ì¹œêµ¬ë“¤ ëª¸ë¬´ê²Œ ë¹„êµ`, font: { size: 18 } } },
                        scales: { x: { title: { display: true, text: 'ëª¸ë¬´ê²Œ (ìˆ«ìê°€ í´ìˆ˜ë¡ ë¬´ê±°ì›Œìš”!)' } } }
                    }
                });
            }
            
            function updateComparisonOptions() {
                const select = container.querySelector('#comparison-group-select');
                const options = [
                    { value: 'life', text: 'ìš°ë¦¬ ëª¸ì„ ë§Œë“œëŠ” ì¹œêµ¬ë“¤' },
                    { value: 'gas', text: 'ë‘¥ì‹¤ë‘¥ì‹¤ ê³µê¸° ì¹œêµ¬ë“¤' },
                    { value: 'tech', text: 'ìŠ¤ë§ˆíŠ¸í° ì† ì¹œêµ¬ë“¤' },
                    { value: 'metal', text: 'ë°˜ì§ë°˜ì§ ê¸ˆì† ì¹œêµ¬ë“¤' }
                ];
                select.innerHTML = '';
                options.forEach(opt => {
                    const isAvailable = allElementsData.some(el => el.level <= currentLevel && el.theme && el.theme.includes(opt.value));
                    if (isAvailable) {
                        const optionEl = document.createElement('option');
                        optionEl.value = opt.value;
                        optionEl.textContent = opt.text;
                        select.appendChild(optionEl);
                    }
                });
                updateComparisonChart();
            }

            container.querySelector('#comparison-group-select').addEventListener('change', updateComparisonChart);

            // Initial setup
            container.querySelector('#level-selector button[data-level="1"]').click();
        });
    </script>
</body>
</html>